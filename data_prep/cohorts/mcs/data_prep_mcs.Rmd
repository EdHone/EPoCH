---
title: "WP3: MCS data preparation"
author: "Gemma Sharp"
date: "12/05/2020"
output: rmdformats::material
---

# Introduction

All datasets were downloaded from the UK data service website and are stored in the EPoCH folder on the RDSF. Documentation is stored alongside the data.

Folder names are not intuitive, so here is a key:

* 4683: First survey
* 5350: Second survey
* 5795: Third survey
* 6411: Fourth survey
* 7464: Fifth survey

The sample population for MCS was drawn from all live births in the United Kingdom over 12 months (from 1 September 2000 in England and Wales and for 59 weeks from 22 November 2000 in Scotland and Northern Ireland).

The first sweep (MCS1) interviewed both mothers and (where resident) fathers (or father-figures) of infants included in the sample when the babies were nine months old, and the second sweep (MCS2) was carried out with the same respondents when the children were three years of age. The third sweep (MCS3) was conducted in 2006, when the children were aged five years old, the fourth sweep (MCS4) in 2008, when they were seven years old, and the fifth sweep (MCS5) in 2012-2013, when they were eleven years old. 

Some studies based on sub-samples of MCS have also been conducted, including a study of MCS respondent mothers who had received assisted fertility treatment, conducted in 2003 (5559).

Interviews were conducted with the baby's mother (or other main carer) and father (or other partner of main carer).

The mother or main carer interviews covered ethnicity and language, the baby's father, lone parenthood, pregnancy, labour and delivery, baby's health and development, childcare, grandparents, friends and social support, parental health, education and training, employment and earnings, housing, community and local services, time with and without the baby and other interests. The interview also included a self-completion element covering baby's temperament and behaviour, relationship with partner, previous relationships, domestic tasks, previous pregnancies, mental health, attitudes to relationships, parenting, work, etc.

The father's or main carer's partner interviews covered ethnicity and language, father's involvement with the baby, lone parenthood, baby's mother (if not resident), grandparents and friends, parental health, education and training, employment and earnings, time with and without the baby and other interests. The self-completion element of the father's/main carer's partner interview covered baby's temperament and behaviour, relationship with partner, previous partners, previous children, mental health and attitudes to marriage, parenting and work.

Either parent or carer could answer the household module questions, which covered household composition and relationships, children, employment status, caring responsibilities for the baby born in 2000 and language spoken at home.

**Proxy module**

If a partner could not be interviewed in person, the main respondent completed a partner interview on their behalf. This is referred to as completing the "proxy module", but is not the full questionnaire. Elsewhere in EPoCH, we refer to this as "maternal report", however, in MCS no health behaviours were asked about in the proxy module. Therefore we have no maternal report variables for MCS.

**Variable naming convention**

Each variable name is eight characters long - made up of the four-letter question name (e.g., ETHE), two single-letter prefixes and two single-character suffixes as follows:

prefix1 prefix2 questionname suffix1 suffix2

* Prefix1: indicates the sweep; a = MCS1; b = MCS2; c = MCS3; d = MCS4; e = MCS5; f = MCS6
* Prefix2: Identifies the instrument/respondent main and partner respondents with the prefixes m and p respectively and proxy partner interviews with x. The full list of potential variants for prefix 2 is: P = Parental respondent, X = Proxy interview, H = Household module completed by main or partner respondent, D = Derived, C = Cohort member ‘level’ data
* Question name: the four-letter question name in the questionnaire
* Suffix1: identifies the iteration, i.e., where the same question is repeated for different events/individuals:
* Suffix 2: identifies a multi-coded variable, ie, where a single question produces more than one answer

**Linking**

Use the mcs_longitudinal_family_file to link. The mcs_longitudinal_family_file can be used for research that focuses on a single sweep of MCS or for a project that requires more than one sweep. The file contains information about the outcomes of a family in each sweep. This means that it can be used to follow cases longitudinally. It also includes the weights that have been calculated for sweeps 1 to 6 and the user can use them either for research on one sweep or when using more than one sweeps.
Specific information on how the weight variables have been constructed for each sweep is provided with the User Guide of the respective sweep.

MCSID

It is the anonymised identifier for each family. The MCSID identifies a family and the individuals within a family can be followed by using PNUM (Person number for any individual other than the Cohort Members) and CNUM (Cohort member number, some families have more than one, e.g. in case of twins). A family holds the same MCSID across sweeps. Similarly, the individuals have the same PNUM and CNUM across sweeps.

DUALBFAM

These families are the cases where a mother gave birth to two Cohort Members within the sample selection period. Both of the children are Cohort Members, however they were not part of a multiple birth (like twins and triplets).

SENTRY

Not all families were interviewed in sweep 1. Some families were interviewed for the first time in sweep 2 and were asked similar questions about the birth of the cohort child as the families that entered the survey in sweep 1. This means that if the research project requires information about birth and the first days of life of Cohort Member, this can be obtained for families that entered the survey in sweep 2.

**Weighting:**

The sample of births selected for the first survey of the MCS was clustered, geographically, and disproportionately stratified to over-represent areas with high proportions of ethnic minorities in England, residents of areas of high child poverty and residents of the three smaller countries of the UK respectively. The sample design weights or probability weights can be used to correct for MCS cases having unequal probabilities of selection that result from the stratified cluster sample design. The sample weights to be used depend on whether the analysis is confined to data relating to a single country. These are the weights for the whole of the UK (called weight 2 in the MCS documentation):

| Strata        | England | Wales | Scotland | N Ireland |
|---------------|---------|-------|----------|-----------|
| Advantaged    | 2.00    | 0.62  | 0.93     | 0.47      |
| Disadvantaged | 1.09    | 0.23  | 0.57     | 0.25      |
| Ethnic        | 0.37    |       |          |           |

There's information on weighting using Stata here: https://cls.ucl.ac.uk/wp-content/uploads/2017/07/User-Guide-to-Analysing-MCS-Data-using-Stata.pdf (I haven't seen information on how to do it using R - it uses a specific command in STATA, svy).

This document [https://cls.ucl.ac.uk/wp-content/uploads/2017/07/MCS-Guide-to-the-Datasets-022014.pdf] contains the following recommendation:
"Analysts wanting to estimate coefficients of regression models should include the stratum design variable (pttype2) as dummy variables in the model and unweighted methods can then be used to estimate model parameters. In order to properly estimate standard errors, the clustering of the MCS sample should be taken into account in any analysis by using the STATA svy commands or robust cluster option with PSU identifier if clustering is a nuisance or using a multilevel (hierarchical) model if the clustering is of substantive interest."

I think this means we can just adjust for PTTYPE2 to adjust the coefficients. To get standard errors that take clustering into account, I'm not sure what we could do...
 
**Partner response**

Taken from http://doc.ukdataservice.ac.uk/doc/4683/mrdoc/pdf/mcs_technical_report_on_sampling_4th_edition.pdf

We can look at the correlates of partner non-response by combining the Child Benefit variables with variables relating to the family or to the mother that are provided by the main respondent even if the partner data are missing. We find that:

1. Partners in ethnic wards in England and disadvantaged wards in Northern Ireland are less likely to respond (odds = 0.59 and 0.51 respectively).
2. Claimants paid by order book are less likely to respond (odds = 0.75).
3. The odds of not responding increase by 1.09 for each extra child in the family.
4. Partners of unmarried main respondents are less likely to respond (odds = 0.67).
5. Partners of Asian and Black main respondents are less likely to respond (odds = 0.64 and 0.47 respectively).
6. Partners where the main respondent’s educational qualifications are below degree level are less likely to respond (odds = 0.82).
7. There is variation from ward to ward in partner non-response that is not explained by the Child Poverty Index.

**Deriving variables**

This (found too late) was an absolute godsend in finding variable names and information: http://cls.nemisys3.uk.com/datadictionary/page.asp?section=000100010003000300020001&sectionTitle=A%2E+Main+Interview

# Loading and merging data

```{r eval=FALSE, include=TRUE}
library(knitr)
library(haven)
family_file <- read_dta("/Volumes/MRC-IEU-research/projects/ieu2/p5/015/working/data/mcs/UKDA-8172-stata11/UKDA-8172-stata11/stata11/mcs_longitudinal_family_file.dta")
names(family_file)<-tolower(names(family_file))

hhg1 <- read_dta("/Volumes/MRC-IEU-research/projects/ieu2/p5/015/working/data/mcs/UKDA-4683-stata11/stata11/mcs1_hhgrid.dta")

mcs1_parent_interview <- read_dta("/Volumes/MRC-IEU-research/projects/ieu2/p5/015/working/data/mcs/UKDA-4683-stata11/UKDA-4683-stata11/stata11/mcs1_parent_interview.dta")
mcs1_derived <- read_dta("/Volumes/MRC-IEU-research/projects/ieu2/p5/015/working/data/mcs/UKDA-4683-stata11/UKDA-4683-stata11/stata11/mcs1_derived_variables.dta")

names(mcs1_derived)<-tolower(names(mcs1_derived))

mcs2_parent_interview <- read_dta("/Volumes/MRC-IEU-research/projects/ieu2/p5/015/working/data/mcs/UKDA-5350-stata11_se/stata11_se/mcs2_parent_interview.dta")
mcs2_child_assessment <- read_dta("/Volumes/MRC-IEU-research/projects/ieu2/p5/015/working/data/mcs/UKDA-5350-stata11_se/stata11_se/mcs2_child_assessment_data.dta")
mcs2_child_measurement <- read_dta("/Volumes/MRC-IEU-research/projects/ieu2/p5/015/working/data/mcs/UKDA-5350-stata11_se/stata11_se/mcs2_child_measurement_data.dta")
mcs2_derived <- read_dta("/Volumes/MRC-IEU-research/projects/ieu2/p5/015/working/data/mcs/UKDA-5350-stata11_se/stata11_se/mcs2_derived_variables.dta")

mcs3_parent_interview <- read_dta("/Volumes/MRC-IEU-research/projects/ieu2/p5/015/working/data/mcs/UKDA-5795-stata11_se/UKDA-5795-stata11_se/stata11_se/mcs3_parent_interview.dta")
mcs3_child_assessment <- read_dta("/Volumes/MRC-IEU-research/projects/ieu2/p5/015/working/data/mcs/UKDA-5795-stata11_se/UKDA-5795-stata11_se/stata11_se/mcs3_child_assessment_data.dta")
mcs3_derived <- read_dta("/Volumes/MRC-IEU-research/projects/ieu2/p5/015/working/data/mcs/UKDA-5795-stata11_se/UKDA-5795-stata11_se/stata11_se/mcs3_derived_variables.dta")

mcs4_parent_interview <- read_dta("/Volumes/MRC-IEU-research/projects/ieu2/p5/015/working/data/mcs/UKDA-6411-stata11_se/UKDA-6411-stata11_se/stata11_se/mcs4_parent_interview.dta")
mcs4_child_assessment <- read_dta("/Volumes/MRC-IEU-research/projects/ieu2/p5/015/working/data/mcs/UKDA-6411-stata11_se/UKDA-6411-stata11_se/stata11_se/mcs4_cm_assessment.dta")
mcs4_derived <- read_dta("/Volumes/MRC-IEU-research/projects/ieu2/p5/015/working/data/mcs/UKDA-6411-stata11_se/UKDA-6411-stata11_se/stata11_se/mcs4_derived_variables.dta")

mcs5_parent_interview <- read_dta("/Volumes/MRC-IEU-research/projects/ieu2/p5/015/working/data/mcs/UKDA-7464-stata11/UKDA-7464-stata11/stata11/mcs5_parent_interview.dta")
mcs5_parent_derived <- read_dta("/Volumes/MRC-IEU-research/projects/ieu2/p5/015/working/data/mcs/UKDA-7464-stata11/UKDA-7464-stata11/stata11/mcs5_parent_derived.dta")
mcs5_child_assessment <- read_dta("/Volumes/MRC-IEU-research/projects/ieu2/p5/015/working/data/mcs/UKDA-7464-stata11/UKDA-7464-stata11/stata11/mcs5_cm_assessment.dta")
mcs5_cm_derived <- read_dta("/Volumes/MRC-IEU-research/projects/ieu2/p5/015/working/data/mcs/UKDA-7464-stata11/UKDA-7464-stata11/stata11/mcs5_cm_derived.dta")
mcs5_child_measurement <- read_dta("/Volumes/MRC-IEU-research/projects/ieu2/p5/015/working/data/mcs/UKDA-7464-stata11/UKDA-7464-stata11/stata11/mcs5_cm_measurement.dta")

mcs1_parent_interview <- zap_labels(mcs1_parent_interview)

# merge parent level datasets (sweeps 1-4 are in wide format, sweep 5 is in long format)

raw_dat <- merge(family_file,mcs1_parent_interview,by="mcsid",all=T)# family file contains one row per family, includes data on weights, mcsid is family id, pnum is adult id, cnum is child id
raw_dat <- merge(raw_dat,mcs2_parent_interview,by="mcsid",all.x=T)
raw_dat <- merge(raw_dat,mcs3_parent_interview,by="mcsid",all.x=T)
raw_dat <- merge(raw_dat,mcs4_parent_interview[,-which(colnames(mcs4_parent_interview) %in% "daoutc00")],by="mcsid",all.x=T)
names(mcs5_parent_interview)<-tolower(names(mcs5_parent_interview))
raw_dat <- merge(raw_dat,mcs5_parent_interview[mcs5_parent_interview$eelig00==1,],by="mcsid",all=T) # by selecting eelig==1, we're selecting data from just one respondent, the one that has been eligible for the role of main respondent - this is fine as we're not actually selecting any parent data by this point, we just want to get the dataset at the family level

names(mcs1_derived)<-tolower(names(mcs1_derived))
names(mcs2_derived)<-tolower(names(mcs2_derived))
names(mcs3_derived)<-tolower(names(mcs3_derived))
names(mcs4_derived)<-tolower(names(mcs4_derived))
names(mcs5_cm_derived)<-tolower(names(mcs5_cm_derived))
names(mcs5_parent_derived)<-tolower(names(mcs5_parent_derived))

duplicated_variables <- intersect(colnames(raw_dat),c(colnames(mcs1_derived),colnames(mcs2_derived),colnames(mcs3_derived),colnames(mcs4_derived),colnames(mcs5_parent_derived)))[-1]

raw_dat <- merge(raw_dat,mcs1_derived,by="mcsid",all.x=T)
raw_dat <- merge(raw_dat,mcs2_derived[,-which(colnames(mcs2_derived)%in%duplicated_variables)],by="mcsid",all.x=T)
raw_dat <- merge(raw_dat,mcs3_derived,by="mcsid",all.x=T)
raw_dat <- merge(raw_dat,mcs4_derived[,-which(colnames(mcs4_derived)%in%duplicated_variables)],by="mcsid",all.x=T)
mcs5_parent_derived2 <- mcs5_parent_derived[mcs5_parent_derived$eelig00==1,]
raw_dat <- merge(raw_dat,mcs5_parent_derived2[,-which(colnames(mcs5_parent_derived2)%in%duplicated_variables)],by="mcsid",all.x=T)

# add child-level data (select just cohort member 1)

names(mcs4_child_assessment)<-tolower(names(mcs4_child_assessment))
names(mcs5_child_assessment)<-tolower(names(mcs5_child_assessment))
names(mcs5_child_measurement)<-tolower(names(mcs5_child_measurement))
names(mcs5_cm_derived)<-tolower(names(mcs5_cm_derived))

mcs2_child_assessment <- mcs2_child_assessment[mcs2_child_assessment$bhcnum00==1,]
mcs2_child_measurement <- mcs2_child_measurement[mcs2_child_measurement$bhcnum00==1,]
mcs3_child_assessment <- mcs3_child_assessment[mcs3_child_assessment$chcnum00==1,]
mcs4_child_assessment <- mcs4_child_assessment[mcs4_child_assessment$dccnum00==1,]
mcs5_child_measurement <- mcs5_child_measurement[mcs5_child_measurement$ecnum00==1,]
mcs5_child_assessment <- mcs5_child_assessment[mcs5_child_assessment$ecnum00==1,]
mcs5_cm_derived <- mcs5_cm_derived[mcs5_cm_derived$ecnum00==1,]

duplicated_variables <- c("cddatrel","bhcnum00","chcnum00","dccnum00","ecnum00")

raw_dat <- merge(raw_dat,mcs2_child_measurement[-which(colnames(mcs2_child_measurement)%in%duplicated_variables)],by="mcsid",all.x=T)
duplicated_variables2 <- c(duplicated_variables,intersect(colnames(raw_dat),colnames(mcs2_child_assessment)))
duplicated_variables2 <-duplicated_variables2[-which(duplicated_variables2=="mcsid")]
raw_dat <- merge(raw_dat,mcs2_child_assessment[-which(colnames(mcs2_child_assessment)%in%duplicated_variables2)],by="mcsid",all.x=T)
duplicated_variables2 <- c(duplicated_variables,intersect(colnames(raw_dat),colnames(mcs3_child_assessment)))
duplicated_variables2 <-duplicated_variables2[-which(duplicated_variables2=="mcsid")]
raw_dat <- merge(raw_dat,mcs3_child_assessment[-which(colnames(mcs3_child_assessment)%in%duplicated_variables2)],by="mcsid",all.x=T)
duplicated_variables2 <- c(duplicated_variables,intersect(colnames(raw_dat),colnames(mcs4_child_assessment)))
duplicated_variables2 <-duplicated_variables2[-which(duplicated_variables2=="mcsid")]
raw_dat <- merge(raw_dat,mcs4_child_assessment[-which(colnames(mcs4_child_assessment)%in%duplicated_variables2)],by="mcsid",all.x=T)
duplicated_variables2 <- c(duplicated_variables,intersect(colnames(raw_dat),colnames(mcs5_child_assessment)))
duplicated_variables2 <-duplicated_variables2[-which(duplicated_variables2=="mcsid")]
raw_dat <- merge(raw_dat,mcs5_child_assessment[-which(colnames(mcs5_child_assessment)%in%duplicated_variables2)],by="mcsid",all.x=T)
duplicated_variables2 <- c(duplicated_variables,intersect(colnames(raw_dat),colnames(mcs5_child_measurement)))
duplicated_variables2 <-duplicated_variables2[-which(duplicated_variables2=="mcsid")]
raw_dat <- merge(raw_dat,mcs5_child_measurement[-which(colnames(mcs5_child_measurement)%in%duplicated_variables2)],by="mcsid",all.x=T)
duplicated_variables2 <- c(duplicated_variables,intersect(colnames(raw_dat),colnames(mcs5_cm_derived)))
duplicated_variables2 <-duplicated_variables2[-which(duplicated_variables2=="mcsid")]
raw_dat <- merge(raw_dat,mcs5_cm_derived[-which(colnames(mcs5_cm_derived)%in%duplicated_variables2)],by="mcsid",all.x=T)

raw_dat <- zap_labels(raw_dat)

```

# Parents' status

In MCS, there are "main respondents" and "partner respondents". Their status is defined using variables amdres00 and apdres00 respectively.

Usually (amdres00==1 n=18497; amdres00!=1 n= 55) the main respondent is the natural mother. There are only 20 records where the natural mother was eligible but not interviewed and 28 records where the natural father was interviewed as the main respondent.

For 13165 records, the "partner respondent" is the natural father (interviewed; apdres00==2). For 1886 records, the partner respondent is the natural father but they were not interviewed (apdres00==16). For 215 respondents, the natural father was included "by proxy" (apdres00==12) meaning that the main respondent answered on the natural father's behalf. For 17 respondents, the natural father was "by proxy, not interviewed" (apdres00==24). For 3194 records the partner respondent is marked as "not applicable (coded as -1). Sample sizes for other types of partner respondent (e.g. step father, adoptive father, natural mother, etc) are all <50.

"Within productive households, the vast majority (88%) of eligible partners were interviewed (or, occasionally, had partner data collected on their behalf). Again, participation was a little higher in Advantaged wards (always over 90 per cent). The notably lower response (79 per cent) in the English wards with high proportions of people from minority ethnic groups may have been related to the long durations of some main interviews in these wards, although this has not been ascertained systematically." (taken from the mcs1 technical report)

```{r eval=FALSE, include=TRUE}

raw_dat <- raw_dat[which(raw_dat$amdres00==1&is.na(raw_dat$amdres00)==FALSE),] # select only those where the natural mother is the main respondent (vast majority of cases, lose 55)

raw_dat <- raw_dat[raw_dat$nocmhh==1,]#select singletons/first borns in cohort (lose 246 + 10)

raw_dat$covs_biological_father<-"not_bio_dad"
raw_dat$covs_biological_father[raw_dat$apdres00%in%c(2,12,16,24)]<-"bio_dad"
raw_dat$covs_biological_father[raw_dat$apdres00==(-1)]<-"no_partner"
raw_dat$covs_biological_father[is.na(raw_dat$apdres00)]<-"missing"

# Paternal participation is defined as a partner (bio dad, foster/adoptive/step, male/female partner) completing the interview themselves (i.e. not by proxy)
raw_dat$paternal_participation <- NA
raw_dat$paternal_participation[raw_dat$apdres00%in%c(2,4,6,8,26,25,31)]<-1
raw_dat$paternal_participation[raw_dat$apdres00%in%c(-1,7,21,22,16,12,24,22,28,30)]<-0

dat<- raw_dat[,c(names(raw_dat)[1:7],"covs_biological_father","paternal_participation")]

```

# Smoking {.tabset}

## Preparing raw data

### Mother
```{r eval=FALSE, include=TRUE}

# Timing specific smoking
raw_dat$smoking_amount_now_mum <-raw_dat$amsmma00 #if smokes cigs or roll-ups now, how many per day?
raw_dat$smoking_amount_now_mum[raw_dat$smoking_amount_now_mum<0]<-NA 
raw_dat$smoking_amount_now_mum[raw_dat$amsmus0a==1|raw_dat$amsmus0b==1|raw_dat$amsmus0c==1] <- 0 #doesn't smoke now

raw_dat$smoking_amount_prepreg_mum <- raw_dat$amcipr00 #if smokes now or has in the past 2 years, how many just before pregnancy
raw_dat$smoking_amount_prepreg_mum[raw_dat$smoking_amount_prepreg_mum<0]<-NA
raw_dat$smoking_amount_prepreg_mum[raw_dat$amsmty00==2]<-0
raw_dat$smoking_amount_prepreg_mum[raw_dat$amsmus0a==1|raw_dat$amsmus0b==1|raw_dat$amsmus0c==1]<-0

raw_dat$smoking_amount_afterchange_mum <- raw_dat$amcich00# how many cigs per day after changed during pregnancy
raw_dat$smoking_amount_afterchange_mum[raw_dat$smoking_amount_afterchange_mum<0]<-NA
raw_dat$smoking_amount_afterchange_mum[raw_dat$smoking_amount_afterchange_mum==97]<-NA # can't remember
raw_dat$smoking_amount_afterchange_mum[raw_dat$smoking_amount_afterchange_mum==96]<-1 # less than 1 per day
raw_dat$smoking_amount_afterchange_mum[raw_dat$smoking_amount_prepreg_mum==0]<-0 #wasn't smoking before pregnancy
raw_dat$smoking_amount_afterchange_mum[raw_dat$amsmch00==2] <- raw_dat$smoking_amount_prepreg_mum[raw_dat$amsmch00==2]#didn't change the amount they smoked

raw_dat$smoking_amount_firsttrim_mum <- raw_dat$smoking_amount_prepreg_mum
raw_dat$smoking_amount_firsttrim_mum[raw_dat$amwhch00%in%c(1,2,3)] <-raw_dat$smoking_amount_afterchange_mum[raw_dat$amwhch00%in%c(1,2,3)]

raw_dat$smoking_amount_secondtrim_mum <- raw_dat$smoking_amount_firsttrim_mum
raw_dat$smoking_amount_secondtrim_mum[raw_dat$amwhch00%in%c(4,5,6)] <-raw_dat$smoking_amount_afterchange_mum[raw_dat$amwhch00%in%c(4,5,6)]

raw_dat$smoking_amount_thirdtrim_mum <- raw_dat$smoking_amount_secondtrim_mum
raw_dat$smoking_amount_thirdtrim_mum[raw_dat$amwhch00%in%c(7,8,9)] <-raw_dat$smoking_amount_afterchange_mum[raw_dat$amwhch00%in%c(7,8,9)]

```
 
### Father
```{r eval=FALSE, include=TRUE}

# Timing specific smoking
raw_dat$smoking_amount_now_dad <-raw_dat$apsmma00 #if smokes cigs or roll-ups now, how many per day?
raw_dat$smoking_amount_now_dad[raw_dat$smoking_amount_now_dad<0]<-NA 
raw_dat$smoking_amount_now_dad[raw_dat$apsmus0a==1|raw_dat$apsmus0b==1|raw_dat$apsmus0c==1|raw_dat$apsmus0d==1] <- 0 #doesn't smoke now

raw_dat$smoking_amount_prepreg_dad <- raw_dat$apcipr00 #if smokes now or has in the past 2 years, how many just before pregnancy
raw_dat$smoking_amount_prepreg_dad[raw_dat$smoking_amount_prepreg_dad<0]<-NA
raw_dat$smoking_amount_prepreg_dad[raw_dat$apsmty00==2]<-0
raw_dat$smoking_amount_prepreg_dad[raw_dat$apsmus0a==1|raw_dat$apsmus0b==1|raw_dat$apsmus0c==1|raw_dat$apsmus0d==1]<-0

raw_dat$smoking_amount_afterchange_dad <- raw_dat$apcich00# how many cigs per day after changed during pregnancy
raw_dat$smoking_amount_afterchange_dad[raw_dat$smoking_amount_afterchange_dad<0]<-NA
raw_dat$smoking_amount_afterchange_dad[raw_dat$smoking_amount_afterchange_dad==97]<-NA # can't remember
raw_dat$smoking_amount_afterchange_dad[raw_dat$smoking_amount_afterchange_dad==96]<-1 # less than 1 per day
raw_dat$smoking_amount_afterchange_dad[raw_dat$smoking_amount_prepreg_dad==0]<-0 #wasn't smoking before pregnancy
raw_dat$smoking_amount_afterchange_dad[raw_dat$apsmch00==2] <- raw_dat$smoking_amount_prepreg_dad[raw_dat$apsmch00==2]#didn't change the amount they smoked

raw_dat$smoking_amount_firsttrim_dad <- raw_dat$smoking_amount_prepreg_dad
raw_dat$smoking_amount_firsttrim_dad[raw_dat$apwhch00%in%c(1,2,3)] <-raw_dat$smoking_amount_afterchange_dad[raw_dat$apwhch00%in%c(1,2,3)]

raw_dat$smoking_amount_secondtrim_dad <- raw_dat$smoking_amount_firsttrim_dad
raw_dat$smoking_amount_secondtrim_dad[raw_dat$apwhch00%in%c(4,5,6)] <-raw_dat$smoking_amount_afterchange_dad[raw_dat$apwhch00%in%c(4,5,6)]

raw_dat$smoking_amount_thirdtrim_dad <- raw_dat$smoking_amount_secondtrim_dad
raw_dat$smoking_amount_thirdtrim_dad[raw_dat$apwhch00%in%c(7,8,9)] <-raw_dat$smoking_amount_afterchange_dad[raw_dat$apwhch00%in%c(7,8,9)]

```

## Deriving variables

### Mother
```{r eval=FALSE, include=TRUE}
#Ever regular smoker
#SMUS: what type smoked NOW, can provide up to 5 response (SMUS0a, SMUS0b etc)

dat$smoking_mother_ever_life_binary <- NA
dat$smoking_mother_ever_life_binary[raw_dat$amsmus0a%in%c(2,3)|raw_dat$amsmus0b%in%c(2,3)|raw_dat$amsmus0c%in%c(2,3)] <- 1 # current smoker (cigarettes or roll-ups)
dat$smoking_mother_ever_life_binary[raw_dat$amsmus0a==1|raw_dat$amsmus0b==1|raw_dat$amsmus0c==1] <- 0 #not current smoker
dat$smoking_mother_ever_life_binary[raw_dat$amsmty00==1] <-1 # if not current smoker, smoked in past 2 years?
dat$smoking_mother_ever_life_binary[raw_dat$amsmev00==1] <-1# if not smoked in past 2 yrs, ever smoked regularly for 12 months or more?

# Preconception
dat$smoking_mother_preconception_binary <- NA
dat$smoking_mother_preconception_binary[raw_dat$smoking_amount_prepreg_mum==0]<-0
dat$smoking_mother_preconception_binary[raw_dat$smoking_amount_prepreg_mum>0]<-1

dat$smoking_mother_preconception_ordinal <- NA
dat$smoking_mother_preconception_ordinal[raw_dat$smoking_amount_prepreg_mum==0]<-"None"
dat$smoking_mother_preconception_ordinal[raw_dat$smoking_amount_prepreg_mum>0 & raw_dat$smoking_amount_prepreg_mum<10]<-"Light" #i.e. <10 but not 0
dat$smoking_mother_preconception_ordinal[raw_dat$smoking_amount_prepreg_mum>=10 & raw_dat$smoking_amount_prepreg_mum<20]<-"Moderate" #i.e. <20, >=10
dat$smoking_mother_preconception_ordinal[raw_dat$smoking_amount_prepreg_mum>=20]<-"Heavy" #i.e.>=20
dat$smoking_mother_preconception_ordinal<-factor(dat$smoking_mother_preconception_ordinal,levels=c("None","Light","Moderate","Heavy"),ordered=T)

# First trimester
dat$smoking_mother_firsttrim_binary <- NA
dat$smoking_mother_firsttrim_binary[raw_dat$smoking_amount_firsttrim_mum==0]<-0
dat$smoking_mother_firsttrim_binary[raw_dat$smoking_amount_firsttrim_mum>0]<-1

dat$smoking_mother_firsttrim_ordinal <- NA
dat$smoking_mother_firsttrim_ordinal[raw_dat$smoking_amount_firsttrim_mum==0]<-"None"
dat$smoking_mother_firsttrim_ordinal[raw_dat$smoking_amount_firsttrim_mum>0 & raw_dat$smoking_amount_firsttrim_mum<10]<-"Light" #i.e. <10 but not 0
dat$smoking_mother_firsttrim_ordinal[raw_dat$smoking_amount_firsttrim_mum>=10 & raw_dat$smoking_amount_firsttrim_mum<20]<-"Moderate" #i.e. <20, >=10
dat$smoking_mother_firsttrim_ordinal[raw_dat$smoking_amount_firsttrim_mum>=20]<-"Heavy" #i.e.>=20
dat$smoking_mother_firsttrim_ordinal<-factor(dat$smoking_mother_firsttrim_ordinal,levels=c("None","Light","Moderate","Heavy"),ordered=T)

# Second trimester
dat$smoking_mother_secondtrim_binary <- NA
dat$smoking_mother_secondtrim_binary[raw_dat$smoking_amount_secondtrim_mum==0]<-0
dat$smoking_mother_secondtrim_binary[raw_dat$smoking_amount_secondtrim_mum>0]<-1

dat$smoking_mother_secondtrim_ordinal <- NA
dat$smoking_mother_secondtrim_ordinal[raw_dat$smoking_amount_secondtrim_mum==0]<-"None"
dat$smoking_mother_secondtrim_ordinal[raw_dat$smoking_amount_secondtrim_mum>0 & raw_dat$smoking_amount_secondtrim_mum<10]<-"Light" #i.e. <10 but not 0
dat$smoking_mother_secondtrim_ordinal[raw_dat$smoking_amount_secondtrim_mum>=10 & raw_dat$smoking_amount_secondtrim_mum<20]<-"Moderate" #i.e. <20, >=10
dat$smoking_mother_secondtrim_ordinal[raw_dat$smoking_amount_secondtrim_mum>=20]<-"Heavy" #i.e.>=20
dat$smoking_mother_secondtrim_ordinal<-factor(dat$smoking_mother_secondtrim_ordinal,levels=c("None","Light","Moderate","Heavy"),ordered=T)

# Third trimester
dat$smoking_mother_thirdtrim_binary <- NA
dat$smoking_mother_thirdtrim_binary[raw_dat$smoking_amount_thirdtrim_mum==0]<-0
dat$smoking_mother_thirdtrim_binary[raw_dat$smoking_amount_thirdtrim_mum>0]<-1

dat$smoking_mother_thirdtrim_ordinal <- NA
dat$smoking_mother_thirdtrim_ordinal[raw_dat$smoking_amount_thirdtrim_mum==0]<-"None"
dat$smoking_mother_thirdtrim_ordinal[raw_dat$smoking_amount_thirdtrim_mum>0 & raw_dat$smoking_amount_thirdtrim_mum<10]<-"Light" #i.e. <10 but not 0
dat$smoking_mother_thirdtrim_ordinal[raw_dat$smoking_amount_thirdtrim_mum>=10 & raw_dat$smoking_amount_thirdtrim_mum<20]<-"Moderate" #i.e. <20, >=10
dat$smoking_mother_thirdtrim_ordinal[raw_dat$smoking_amount_thirdtrim_mum>=20]<-"Heavy" #i.e.>=20
dat$smoking_mother_thirdtrim_ordinal<-factor(dat$smoking_mother_thirdtrim_ordinal,levels=c("None","Light","Moderate","Heavy"),ordered=T)

# Any time in pregnancy
dat$smoking_mother_ever_pregnancy_binary<-NA
dat$smoking_mother_ever_pregnancy_binary[dat$smoking_mother_firsttrim_binary==0 & dat$smoking_mother_secondtrim_binary==0 &dat$smoking_mother_thirdtrim_binary==0] <- 0
dat$smoking_mother_ever_pregnancy_binary[dat$smoking_mother_firsttrim_binary==1 | dat$smoking_mother_secondtrim_binary==1 | dat$smoking_mother_thirdtrim_binary==1] <- 1

# Postnatal
dat$smoking_mother_postnatal_binary <- NA
dat$smoking_mother_postnatal_binary[raw_dat$smoking_amount_now_mum==0]<-0
dat$smoking_mother_postnatal_binary[raw_dat$smoking_amount_now_mum>0]<-1

dat$smoking_mother_postnatal_ordinal <- NA
dat$smoking_mother_postnatal_ordinal[raw_dat$smoking_amount_now_mum==0]<-"None"
dat$smoking_mother_postnatal_ordinal[raw_dat$smoking_amount_now_mum>0 & raw_dat$smoking_amount_now_mum<10]<-"Light" #i.e. <10 but not 0
dat$smoking_mother_postnatal_ordinal[raw_dat$smoking_amount_now_mum>=10 & raw_dat$smoking_amount_now_mum<20]<-"Moderate" #i.e. <20, >=10
dat$smoking_mother_postnatal_ordinal[raw_dat$smoking_amount_now_mum>=20]<-"Heavy" #i.e.>=20
dat$smoking_mother_postnatal_ordinal<-factor(dat$smoking_mother_postnatal_ordinal,levels=c("None","Light","Moderate","Heavy"),ordered=T)

```

### Father
```{r eval=FALSE, include=TRUE}
#Ever regular smoker
#SMUS: what type smoked NOW, can provide up to 5 response (SMUS0a, SMUS0b etc)

dat$smoking_father_ever_life_binary <- NA
dat$smoking_father_ever_life_binary[raw_dat$apsmus0a%in%c(2,3)|raw_dat$apsmus0b%in%c(2,3)|raw_dat$apsmus0c%in%c(2,3)|raw_dat$apsmus0d%in%c(2,3)] <- 1 # current smoker (cigarettes or roll-ups)
dat$smoking_father_ever_life_binary[raw_dat$apsmus0a==1|raw_dat$apsmus0b==1|raw_dat$apsmus0c==1|raw_dat$apsmus0d==1] <- 0 #not current smoker
dat$smoking_father_ever_life_binary[raw_dat$apsmty00==1] <-1 # if not current smoker, smoked in past 2 years?
dat$smoking_father_ever_life_binary[raw_dat$apsmev00==1] <-1# if not smoked in past 2 yrs, ever smoked regularly for 12 months or more?

# Preconception
dat$smoking_father_preconception_binary <- NA
dat$smoking_father_preconception_binary[raw_dat$smoking_amount_prepreg_dad==0]<-0
dat$smoking_father_preconception_binary[raw_dat$smoking_amount_prepreg_dad>0]<-1

dat$smoking_father_preconception_ordinal <- NA
dat$smoking_father_preconception_ordinal[raw_dat$smoking_amount_prepreg_dad==0]<-"None"
dat$smoking_father_preconception_ordinal[raw_dat$smoking_amount_prepreg_dad>0 & raw_dat$smoking_amount_prepreg_dad<10]<-"Light" #i.e. <10 but not 0
dat$smoking_father_preconception_ordinal[raw_dat$smoking_amount_prepreg_dad>=10 & raw_dat$smoking_amount_prepreg_dad<20]<-"Moderate" #i.e. <20, >=10
dat$smoking_father_preconception_ordinal[raw_dat$smoking_amount_prepreg_dad>=20]<-"Heavy" #i.e.>=20
dat$smoking_father_preconception_ordinal<-factor(dat$smoking_father_preconception_ordinal,levels=c("None","Light","Moderate","Heavy"),ordered=T)

# First trimester
dat$smoking_father_firsttrim_binary <- NA
dat$smoking_father_firsttrim_binary[raw_dat$smoking_amount_firsttrim_dad==0]<-0
dat$smoking_father_firsttrim_binary[raw_dat$smoking_amount_firsttrim_dad>0]<-1

dat$smoking_father_firsttrim_ordinal <- NA
dat$smoking_father_firsttrim_ordinal[raw_dat$smoking_amount_firsttrim_dad==0]<-"None"
dat$smoking_father_firsttrim_ordinal[raw_dat$smoking_amount_firsttrim_dad>0 & raw_dat$smoking_amount_firsttrim_dad<10]<-"Light" #i.e. <10 but not 0
dat$smoking_father_firsttrim_ordinal[raw_dat$smoking_amount_firsttrim_dad>=10 & raw_dat$smoking_amount_firsttrim_dad<20]<-"Moderate" #i.e. <20, >=10
dat$smoking_father_firsttrim_ordinal[raw_dat$smoking_amount_firsttrim_dad>=20]<-"Heavy" #i.e.>=20
dat$smoking_father_firsttrim_ordinal<-factor(dat$smoking_father_firsttrim_ordinal,levels=c("None","Light","Moderate","Heavy"),ordered=T)

# Second trimester
dat$smoking_father_secondtrim_binary <- NA
dat$smoking_father_secondtrim_binary[raw_dat$smoking_amount_secondtrim_dad==0]<-0
dat$smoking_father_secondtrim_binary[raw_dat$smoking_amount_secondtrim_dad>0]<-1

dat$smoking_father_secondtrim_ordinal <- NA
dat$smoking_father_secondtrim_ordinal[raw_dat$smoking_amount_secondtrim_dad==0]<-"None"
dat$smoking_father_secondtrim_ordinal[raw_dat$smoking_amount_secondtrim_dad>0 & raw_dat$smoking_amount_secondtrim_dad<10]<-"Light" #i.e. <10 but not 0
dat$smoking_father_secondtrim_ordinal[raw_dat$smoking_amount_secondtrim_dad>=10 & raw_dat$smoking_amount_secondtrim_dad<20]<-"Moderate" #i.e. <20, >=10
dat$smoking_father_secondtrim_ordinal[raw_dat$smoking_amount_secondtrim_dad>=20]<-"Heavy" #i.e.>=20
dat$smoking_father_secondtrim_ordinal<-factor(dat$smoking_father_secondtrim_ordinal,levels=c("None","Light","Moderate","Heavy"),ordered=T)

# Third trimester
dat$smoking_father_thirdtrim_binary <- NA
dat$smoking_father_thirdtrim_binary[raw_dat$smoking_amount_thirdtrim_dad==0]<-0
dat$smoking_father_thirdtrim_binary[raw_dat$smoking_amount_thirdtrim_dad>0]<-1

dat$smoking_father_thirdtrim_ordinal <- NA
dat$smoking_father_thirdtrim_ordinal[raw_dat$smoking_amount_thirdtrim_dad==0]<-"None"
dat$smoking_father_thirdtrim_ordinal[raw_dat$smoking_amount_thirdtrim_dad>0 & raw_dat$smoking_amount_thirdtrim_dad<10]<-"Light" #i.e. <10 but not 0
dat$smoking_father_thirdtrim_ordinal[raw_dat$smoking_amount_thirdtrim_dad>=10 & raw_dat$smoking_amount_thirdtrim_dad<20]<-"Moderate" #i.e. <20, >=10
dat$smoking_father_thirdtrim_ordinal[raw_dat$smoking_amount_thirdtrim_dad>=20]<-"Heavy" #i.e.>=20
dat$smoking_father_thirdtrim_ordinal<-factor(dat$smoking_father_thirdtrim_ordinal,levels=c("None","Light","Moderate","Heavy"),ordered=T)

# Any time in pregnancy
dat$smoking_father_ever_pregnancy_binary<-NA
dat$smoking_father_ever_pregnancy_binary[dat$smoking_father_firsttrim_binary==0 & dat$smoking_father_secondtrim_binary==0 &dat$smoking_father_thirdtrim_binary==0] <- 0
dat$smoking_father_ever_pregnancy_binary[dat$smoking_father_firsttrim_binary==1 | dat$smoking_father_secondtrim_binary==1 | dat$smoking_father_thirdtrim_binary==1] <- 1

# Postnatal
dat$smoking_father_postnatal_binary <- NA
dat$smoking_father_postnatal_binary[raw_dat$smoking_amount_now_dad==0]<-0
dat$smoking_father_postnatal_binary[raw_dat$smoking_amount_now_dad>0]<-1

dat$smoking_father_postnatal_ordinal <- NA
dat$smoking_father_postnatal_ordinal[raw_dat$smoking_amount_now_dad==0]<-"None"
dat$smoking_father_postnatal_ordinal[raw_dat$smoking_amount_now_dad>0 & raw_dat$smoking_amount_now_dad<10]<-"Light" #i.e. <10 but not 0
dat$smoking_father_postnatal_ordinal[raw_dat$smoking_amount_now_dad>=10 & raw_dat$smoking_amount_now_dad<20]<-"Moderate" #i.e. <20, >=10
dat$smoking_father_postnatal_ordinal[raw_dat$smoking_amount_now_dad>=20]<-"Heavy" #i.e.>=20
dat$smoking_father_postnatal_ordinal<-factor(dat$smoking_father_postnatal_ordinal,levels=c("None","Light","Moderate","Heavy"),ordered=T)

```

# Alcohol {.tabset}

Questions about drinking alcohol in pregnancy were only asked to natural mothers. However, fathers were asked about drinking "now" (postnatally)

## Mother
```{r eval=FALSE, include=TRUE}

#During pregnancy
raw_dat$alcohol_preg_mother <- raw_dat$amdrof00 # Which of these best describes how often you usually drank alcohol when pregnant?
#1 Every day
#2 5-6 times per week
#3 3-4 times per week
#4 1-2 times per week
#5 1-2 times per month
#6 Less than once a month
#7 Never

dat$alcohol_mother_ever_pregnancy_binary <-NA
dat$alcohol_mother_ever_pregnancy_binary[raw_dat$alcohol_preg_mother==7]<-0
dat$alcohol_mother_ever_pregnancy_binary[raw_dat$alcohol_preg_mother %in% c(1,2,3,4,5,6)]<-1

dat$alcohol_mother_ever_pregnancy_ordinal <- NA
dat$alcohol_mother_ever_pregnancy_ordinal[raw_dat$alcohol_preg_mother==7]<-"None"
dat$alcohol_mother_ever_pregnancy_ordinal[raw_dat$alcohol_preg_mother%in%c(5,6)]<-"Light" # <1glass per week
dat$alcohol_mother_ever_pregnancy_ordinal[raw_dat$alcohol_preg_mother%in%c(2,3,4)]<-"Moderate" #1+glasses pwk, but not daily
dat$alcohol_mother_ever_pregnancy_ordinal[raw_dat$alcohol_preg_mother==1]<-"Heavy" #daily drinking, 1-2pd, 3-9pd, 10+pd
dat$alcohol_mother_ever_pregnancy_ordinal<-factor(dat$alcohol_mother_ever_pregnancy_ordinal, levels=c("None","Light","Moderate","Heavy"),ordered=T)


#Now (postnatal)
raw_dat$alcohol_now_mother <- raw_dat$amaldr00 # Which of these best describes how often you usually drink alcohol?
#1 Every day
#2 5-6 times per week
#3 3-4 times per week
#4 1-2 times per week
#5 1-2 times per month
#6 Less than once a month
#7 Never

dat$alcohol_mother_postnatal_binary <-NA
dat$alcohol_mother_postnatal_binary[raw_dat$alcohol_now_mother==7]<-0
dat$alcohol_mother_postnatal_binary[raw_dat$alcohol_now_mother %in% c(1,2,3,4,5,6)]<-1

dat$alcohol_mother_postnatal_ordinal <- NA
dat$alcohol_mother_postnatal_ordinal[raw_dat$alcohol_now_mother==7]<-"None"
dat$alcohol_mother_postnatal_ordinal[raw_dat$alcohol_now_mother%in%c(5,6)]<-"Light" # <1glass per week
dat$alcohol_mother_postnatal_ordinal[raw_dat$alcohol_now_mother%in%c(2,3,4)]<-"Moderate" #1+glasses pwk, but not daily
dat$alcohol_mother_postnatal_ordinal[raw_dat$alcohol_now_mother==1]<-"Heavy" #daily drinking, 1-2pd, 3-9pd, 10+pd
dat$alcohol_mother_postnatal_ordinal<-factor(dat$alcohol_mother_postnatal_ordinal, levels=c("None","Light","Moderate","Heavy"),ordered=T)

```

## Father
```{r eval=FALSE, include=TRUE}

#Now (postnatal)
raw_dat$alcohol_now_father <- raw_dat$apaldr00 # Which of these best describes how often you usually drink alcohol?
#1 Every day
#2 5-6 times per week
#3 3-4 times per week
#4 1-2 times per week
#5 1-2 times per month
#6 Less than once a month
#7 Never

dat$alcohol_father_postnatal_binary <-NA
dat$alcohol_father_postnatal_binary[raw_dat$alcohol_now_father==7]<-0
dat$alcohol_father_postnatal_binary[raw_dat$alcohol_now_father %in% c(1,2,3,4,5,6)]<-1

dat$alcohol_father_postnatal_ordinal <- NA
dat$alcohol_father_postnatal_ordinal[raw_dat$alcohol_now_father==7]<-"None"
dat$alcohol_father_postnatal_ordinal[raw_dat$alcohol_now_father%in%c(5,6)]<-"Light" # <1glass per week
dat$alcohol_father_postnatal_ordinal[raw_dat$alcohol_now_father%in%c(2,3,4)]<-"Moderate" #1+glasses pwk, but not daily
dat$alcohol_father_postnatal_ordinal[raw_dat$alcohol_now_father==1]<-"Heavy" #daily drinking, 1-2pd, 3-9pd, 10+pd
dat$alcohol_father_postnatal_ordinal<-factor(dat$alcohol_father_postnatal_ordinal, levels=c("None","Light","Moderate","Heavy"),ordered=T)


```

# Anthropometry

Measurements are taken just for child A, so if it was a multiple pregnancy, I haven't extracted data on the other children from that pregnancy.

Ideal harmonised anthropometry and adiposity measures for offspring are:

* Birthweight (g)
* SGA
* LGA
* Low BW <2500g vs >=2500g & <=4500g
* High BW > 4500g vs >=2500g & <=4500g
* Birth length (cm)
* Head circumference (cm)
* Height (cm)
* Waist circumference (cm)
* Weight (kg)
* BMI (kg/m2)
* WHO categories of overweight/obese/underweight vs normal weight
* Fat mass index

Ages are defined as:

* at birth or in first year of life (>0 to <1)
* childhood stage 1 (around age 2; >=1 to <3)
* childhood stage 2 (around age 4; >=3 to <5)
* childhood stage 3 (around age 6; >=5 to <8)
* childhood stage 4 (around age 9; >=8 to <11)

```{r eval=FALSE, include=TRUE}

# Birthweight (g)
dat$anthro_birthweight <- raw_dat$adbwgta0 #bw in kg
dat$anthro_birthweight[raw_dat$adbwgta0<0]<-NA
dat$anthro_birthweight <-dat$anthro_birthweight*1000

dat$anthro_birthweight_high_binary <- NA
dat$anthro_birthweight_high_binary[dat$anthro_birthweight>4500]<-1
dat$anthro_birthweight_high_binary[dat$anthro_birthweight>=2500&dat$anthro_birthweight<=4500]<-0

dat$anthro_birthweight_low_binary <- NA
dat$anthro_birthweight_low_binary[dat$anthro_birthweight<2500]<-1
dat$anthro_birthweight_low_binary[dat$anthro_birthweight>=2500&dat$anthro_birthweight<=4500]<-0

#SGA
#LGA

#Birth length (cm) - not available
#Waist circumference (cm)

raw_dat$waist_measurement_1 <- raw_dat$cywsma00
raw_dat$waist_measurement_1[raw_dat$waist_measurement_1<0]<-NA
raw_dat$waist_measurement_2 <- raw_dat$cywsmb00
raw_dat$waist_measurement_2[raw_dat$waist_measurement_2<0]<-NA
raw_dat$waist_measurement_3 <- raw_dat$cywsmc00
raw_dat$waist_measurement_3[raw_dat$waist_measurement_3<0]<-NA

dat$anthro_waist_stage3 <- rowMeans(raw_dat[,c("waist_measurement_1","waist_measurement_2","waist_measurement_3")],na.rm = T)
dat$anthro_waist_stage3_zscore <- scale(dat$anthro_waist_stage3)

#Head circumference (cm) - not available

#Height (cm)

dat$anthro_height_stage2 <- raw_dat$bdhcmc00
dat$anthro_height_stage2[dat$anthro_height_stage2<0]<-NA
dat$anthro_height_stage2_zscore <- scale(dat$anthro_height_stage2)

dat$anthro_height_stage3 <- raw_dat$cyhtcm00
dat$anthro_height_stage3[dat$anthro_height_stage3<0]<-NA
dat$anthro_height_stage3_zscore <- scale(dat$anthro_height_stage3)

  ## according to the documentation, wave 4 (d, i.e. stage 3 age 7) seems to have child
  ## anthropometry data, but the variables don't appear in the datasets...

dat$anthro_height_stage4 <- raw_dat$echtcma0
dat$anthro_height_stage4[dat$anthro_height_stage4<0]<-NA
dat$anthro_height_stage4_zscore <- scale(dat$anthro_height_stage4)

#Weight (kg)

dat$anthro_weight_stage0 <- raw_dat$adlstwa0
dat$anthro_weight_stage0[dat$anthro_weight_stage0<0]<-NA
dat$anthro_weight_stage0_zscore <- scale(dat$anthro_weight_stage0)

dat$anthro_weight_stage2 <- raw_dat$bdwtkc00 + (raw_dat$bdwtgc00/10) # kg + g
dat$anthro_weight_stage2[dat$anthro_weight_stage2<0]<-NA
dat$anthro_weight_stage2_zscore <- scale(dat$anthro_weight_stage2)

dat$anthro_weight_stage3 <- raw_dat$cywtcm00
dat$anthro_weight_stage3[dat$anthro_weight_stage3<0]<-NA
dat$anthro_weight_stage3_zscore <- scale(dat$anthro_weight_stage3)

  ## according to the documentation, wave 4 (d, i.e. stage 3 age 7) seems to have child      anthropometry data, but the variables don't appear in the datasets...

dat$anthro_weight_stage4 <- raw_dat$ecwtcma0
dat$anthro_weight_stage4[dat$anthro_weight_stage4<0]<-NA
dat$anthro_weight_stage4_zscore <- scale(dat$anthro_weight_stage4)


#BMI and WHO categories of overweight/obese/underweight vs normal weight

dat$anthro_bmi_stage2 <- dat$anthro_weight_stage2 / ((dat$anthro_height_stage2/100)^2)
dat$anthro_bmi_stage3 <- dat$anthro_weight_stage3 / ((dat$anthro_height_stage3/100)^2)
dat$anthro_bmi_stage4 <- dat$anthro_weight_stage4 / ((dat$anthro_height_stage4/100)^2)

# (first need to derive age at each stage/sweep):

dat$covs_age_child_stage0wt <- raw_dat$adaglwa0 # age when weight measurement taken
dat$covs_age_child_stage0wt[dat$covs_age_child_stage0wt<0]<-NA

dat$covs_age_child_stage0 <- raw_dat$ahbage00 #age at interview
dat$covs_age_child_stage0[dat$covs_age_child_stage0<0]<-NA

dat$covs_age_child_stage2 <- raw_dat$bhcagea0
dat$covs_age_child_stage2[dat$covs_age_child_stage2<0]<-NA

dat$covs_age_child_stage3c <- raw_dat$chcagea0
dat$covs_age_child_stage3c[dat$covs_age_child_stage3c<0]<-NA

dat$covs_age_child_stage3d <- raw_dat$dhcagea0
dat$covs_age_child_stage3d[dat$covs_age_child_stage3d<0]<-NA

dat$covs_age_child_stage4 <- raw_dat$emcs5age
dat$covs_age_child_stage4[dat$covs_age_child_stage4<0]<-NA

dat$covs_sex <- NA
dat$covs_sex[raw_dat$ahcsexa0==1]<-"male"
dat$covs_sex[raw_dat$ahcsexa0==2]<-"female"

library(childsds)

dat$anthro_bmi_stage2_sds <- sds(value = dat$anthro_bmi_stage2,
		      age = dat$covs_age_child_stage2,
		      sex = dat$covs_sex, male = "male", female = "female",
		      ref = ukwho.ref, item = "bmi")

dat$anthro_bmi_stage3_sds <- sds(value = dat$anthro_bmi_stage3,
		      age = dat$covs_age_child_stage3c,
		      sex = dat$covs_sex, male = "male", female = "female",
		      ref = ukwho.ref, item = "bmi")

dat$anthro_bmi_stage4_sds <- sds(value = dat$anthro_bmi_stage4,
		      age = dat$covs_age_child_stage4,
		      sex = dat$covs_sex, male = "male", female = "female",
		      ref = ukwho.ref, item = "bmi")

dat$anthro_obese_stage2_binary <- NA
dat$anthro_obese_stage2_binary[which(dat$anthro_bmi_stage2_sds>2)] <-1
dat$anthro_obese_stage2_binary[which(dat$anthro_bmi_stage2_sds<=1 &dat$anthro_bmi_stage2_sds>=(-2))] <-0

dat$anthro_obese_stage3_binary <- NA
dat$anthro_obese_stage3_binary[which(dat$anthro_bmi_stage3_sds>2)] <-1
dat$anthro_obese_stage3_binary[which(dat$anthro_bmi_stage3_sds<=1 &dat$anthro_bmi_stage3_sds>=(-2))] <-0

dat$anthro_obese_stage4_binary <- NA
dat$anthro_obese_stage4_binary[which(dat$anthro_bmi_stage4_sds>2)] <-1
dat$anthro_obese_stage4_binary[which(dat$anthro_bmi_stage4_sds<=1 &dat$anthro_bmi_stage4_sds>=(-2))] <-0

#Body fat PERCENT (note, not fat mass index)

dat$anthro_fatpc_stage4 <- raw_dat$ecbfpc00
dat$anthro_fatpc_stage4[dat$anthro_fatpc_stage4<0]<-NA
dat$anthro_fatpc_stage4_zscore <- scale(dat$anthro_fatpc_stage4)


```

# Psychosocial

Ideal harmonised psychosocial and cognitive measures for offspring are:

Total behavioural difficulties (SDQ) - maternal report, continuous and dichotomised at >=17 [this is a combination of 4 subscales - excluding prosocial behaviour]
Hyperactivity (SDQ) - maternal report, continuous and dichotomised at >=17
Emotional symptoms (SDQ) - maternal report, continuous and dichotomised at >=5
Conduct problems (SDQ) - maternal report, continuous and dichotomised at >=4
Peer problems (SDQ) - maternal report, continuous and dichotomised at >=4
Prosocial behaviour (SDQ) - maternal report, continuous and dichotomised at <=6
Internalising problems (SDQ) - maternal report, combination of emotional symptoms and peer problems
Externalising problems (SDQ) - maternal report, combination of hyperactivity and conduct problems

Social Communication, e.g. SCDC (Skuse Social Communication Score)

Depressive symptoms (e.g. Moods and Feelings questionnaire - MFQ)

IQ and/or other or composite measures of intelligence/cognitive performance
Educational attainment

Ages are defined as:

at birth or in first year of life (>0 to <1)
childhood stage 1 (around age 2; >=1 to <3)
childhood stage 2 (around age 4; >=3 to <5)
childhood stage 3 (around age 6; >=5 to <8)
childhood stage 4 (around age 9; >=8 to <11)

```{r eval=FALSE, include=TRUE}

#Total behavioural difficulties (SDQ) - maternal report, continuous and dichotomised at >=17 [this is a combination of 4 subscales - excluding prosocial behaviour]
#Stage 2
dat$neuro_totalsdq_stage2<-raw_dat$bdebdta0
dat$neuro_totalsdq_stage2[raw_dat$bdebdta0<0]<-NA
dat$neuro_totalsdq_stage2_zscore <- scale(dat$neuro_totalsdq_stage2)
dat$neuro_totalsdq_stage2_binary <- NA
dat$neuro_totalsdq_stage2_binary[dat$neuro_totalsdq_stage2>=17]<-1
dat$neuro_totalsdq_stage2_binary[dat$neuro_totalsdq_stage2<17]<-0

#Stage 3
dat$neuro_totalsdq_stage3<-raw_dat$ddebdta0
dat$neuro_totalsdq_stage3[raw_dat$ddebdta0<0]<-NA
dat$neuro_totalsdq_stage3_zscore <- scale(dat$neuro_totalsdq_stage3)
dat$neuro_totalsdq_stage3_binary <- NA
dat$neuro_totalsdq_stage3_binary[dat$neuro_totalsdq_stage3>=17]<-1
dat$neuro_totalsdq_stage3_binary[dat$neuro_totalsdq_stage3<17]<-0

#Hyperactivity (SDQ) - maternal report, continuous and dichotomised at >=17
#Stage 2
dat$neuro_hyperactivity_stage2<-raw_dat$bdhypea0
dat$neuro_hyperactivity_stage2[raw_dat$bdhypea0<0]<-NA
dat$neuro_hyperactivity_stage2_zscore <- scale(dat$neuro_hyperactivity_stage2)
dat$neuro_hyperactivity_stage2_binary <- NA
dat$neuro_hyperactivity_stage2_binary[dat$neuro_hyperactivity_stage2>=7]<-1
dat$neuro_hyperactivity_stage2_binary[dat$neuro_hyperactivity_stage2<7]<-0
#Stage 3
dat$neuro_hyperactivity_stage3<-raw_dat$ddhypea0
dat$neuro_hyperactivity_stage3[raw_dat$ddhypea0<0]<-NA
dat$neuro_hyperactivity_stage3_zscore <- scale(dat$neuro_hyperactivity_stage3)
dat$neuro_hyperactivity_stage3_binary <- NA
dat$neuro_hyperactivity_stage3_binary[dat$neuro_hyperactivity_stage3>=7]<-1
dat$neuro_hyperactivity_stage3_binary[dat$neuro_hyperactivity_stage3<7]<-

#Emotional symptoms (SDQ) - maternal report, continuous and dichotomised at >=5
#Stage 2
dat$neuro_emotional_stage2<-raw_dat$bdemota0
dat$neuro_emotional_stage2[raw_dat$bdemota0<0]<-NA
dat$neuro_emotional_stage2_zscore <- scale(dat$neuro_emotional_stage2)
dat$neuro_emotional_stage2_binary <- NA
dat$neuro_emotional_stage2_binary[dat$neuro_emotional_stage2>=5]<-1
dat$neuro_emotional_stage2_binary[dat$neuro_emotional_stage2<5]<-0
#Stage 3  
dat$neuro_emotional_stage3<-raw_dat$ddemota0
dat$neuro_emotional_stage3[raw_dat$ddemota0<0]<-NA
dat$neuro_emotional_stage3_zscore <- scale(dat$neuro_emotional_stage3)
dat$neuro_emotional_stage3_binary <- NA
dat$neuro_emotional_stage3_binary[dat$neuro_emotional_stage3>=5]<-1
dat$neuro_emotional_stage3_binary[dat$neuro_emotional_stage3<5]<-0

#Conduct problems (SDQ) - maternal report, continuous and dichotomised at >=4
#Stage 2
dat$neuro_conduct_stage2<-raw_dat$bdconda0
dat$neuro_conduct_stage2[raw_dat$bdconda0<0]<-NA
dat$neuro_conduct_stage2_zscore <- scale(dat$neuro_conduct_stage2)
dat$neuro_conduct_stage2_binary <- NA
dat$neuro_conduct_stage2_binary[dat$neuro_conduct_stage2>=4]<-1
dat$neuro_conduct_stage2_binary[dat$neuro_conduct_stage2<4]<-0
#Stage 3
dat$neuro_conduct_stage3<-raw_dat$ddconda0
dat$neuro_conduct_stage3[raw_dat$ddconda0<0]<-NA
dat$neuro_conduct_stage3_zscore <- scale(dat$neuro_conduct_stage3)
dat$neuro_conduct_stage3_binary <- NA
dat$neuro_conduct_stage3_binary[dat$neuro_conduct_stage3>=4]<-1
dat$neuro_conduct_stage3_binary[dat$neuro_conduct_stage3<4]<-0

#Peer problems (SDQ) - maternal report, continuous and dichotomised at >=4
#Stage 2
dat$neuro_peer_stage2<-raw_dat$bdpeera0
dat$neuro_peer_stage2[raw_dat$bdpeera0<0]<-NA
dat$neuro_peer_stage2_zscore <- scale(dat$neuro_peer_stage2)
dat$neuro_peer_stage2_binary <- NA
dat$neuro_peer_stage2_binary[dat$neuro_peer_stage2>=4]<-1
dat$neuro_peer_stage2_binary[dat$neuro_peer_stage2<4]<-0
#Stage 3
dat$neuro_peer_stage3<-raw_dat$ddpeera0
dat$neuro_peer_stage3[raw_dat$ddpeera0<0]<-NA
dat$neuro_peer_stage3_zscore <- scale(dat$neuro_peer_stage3)
dat$neuro_peer_stage3_binary <- NA
dat$neuro_peer_stage3_binary[dat$neuro_peer_stage3>=4]<-1
dat$neuro_peer_stage3_binary[dat$neuro_peer_stage3<4]<-0

#Prosocial behaviour (SDQ) - maternal report, continuous and dichotomised at <=6
#Stage 2
dat$neuro_prosocial_stage2<-raw_dat$bdprosa0
dat$neuro_prosocial_stage2[raw_dat$bdprosa0<0]<-NA
dat$neuro_prosocial_stage2_zscore <- scale(dat$neuro_prosocial_stage2)
dat$neuro_prosocial_stage2_binary <- NA
dat$neuro_prosocial_stage2_binary[dat$neuro_prosocial_stage2<=6]<-1
dat$neuro_prosocial_stage2_binary[dat$neuro_prosocial_stage2>6]<-0
#Stage 3
dat$neuro_prosocial_stage3<-raw_dat$ddprosa0
dat$neuro_prosocial_stage3[raw_dat$ddprosa0<0]<-NA
dat$neuro_prosocial_stage3_zscore <- scale(dat$neuro_prosocial_stage3)
dat$neuro_prosocial_stage3_binary <- NA
dat$neuro_prosocial_stage3_binary[dat$neuro_prosocial_stage3<=6]<-1
dat$neuro_prosocial_stage3_binary[dat$neuro_prosocial_stage3>6]<-0

#Internalising problems (SDQ) - maternal report, combination of emotional symptoms and peer problems
#Stage 2
dat$neuro_internalising_stage2 <- rowSums(dat[,c("neuro_emotional_stage2","neuro_peer_stage2")])
dat$neuro_internalising_stage2_zscore <- scale(dat$neuro_internalising_stage2)

#Stage 3
dat$neuro_internalising_stage3 <- rowSums(dat[,c("neuro_emotional_stage3","neuro_peer_stage3")])
dat$neuro_internalising_stage3_zscore <- scale(dat$neuro_internalising_stage3)

#Externalising problems (SDQ) - maternal report, combination of hyperactivity and conduct problems
#Stage 2
dat$neuro_externalising_stage2 <- rowSums(dat[,c("neuro_emotional_stage2","neuro_peer_stage2")])
dat$neuro_externalising_stage2_zscore <- scale(dat$neuro_externalising_stage2)
#Stage 3
dat$neuro_externalising_stage3 <- rowSums(dat[,c("neuro_hyperactivity_stage3","neuro_conduct_stage3")])
dat$neuro_externalising_stage3_zscore <- scale(dat$neuro_externalising_stage3)

#SCDC (Skuse Social Communication Score) - not available, but CSBQ Child Social Behaviour Questionnaire is available - is this comparable?

dat$neuro_csbqindependence_stage3 <- raw_dat$cdcsbia0
dat$neuro_csbqindependence_stage3[dat$neuro_csbqindependence_stage3<0]<-NA
dat$neuro_csbqindependence_stage3_zscore <- scale(dat$neuro_csbqindependence_stage3)

dat$neuro_csbqemotionaldysreg_stage3 <- raw_dat$cdcsbea0
dat$neuro_csbqemotionaldysreg_stage3[dat$neuro_csbqemotionaldysreg_stage3<0]<-NA
dat$neuro_csbqemotionaldysreg_stage3_zscore <- scale(dat$neuro_csbqemotionaldysreg_stage3)

#Depressive symptoms (Moods and Feelings questionnaire - MFQ) - not available

#IQ and/or other or composite measures of intelligence/cognitive performance 
# using the British Ability Scales (BAS):
#The British Ability Scales (BAS) is a battery of individually administered tests of
#cognitive abilities and educational achievements suitable for use with children and
#adolescents aged from 2 years 6 months to 7 years 11 months.

#The Naming Vocabulary is a verbal scale for children aged 2 years 6 months to 7
#years 11 months. It assesses the spoken vocabulary of young children.
#Naming Vocabulary scores may reflect:
# Expressive language skills
# Vocabulary knowledge of nouns
# Ability to attach verbal labels to pictures
# General knowledge
# General language development
# Retrieval of names from long-term memory
# Level of language stimulation.

dat$neuro_cognition_namingvocab_stage3 <- raw_dat$cdnvabil
dat$neuro_cognition_namingvocab_stage3[raw_dat$neuro_cognition_namingvocab_stage3<0]<-NA
dat$neuro_cognition_namingvocab_stage3_zscore <- scale(dat$neuro_cognition_namingvocab_stage3)

dat$neuro_cognition_namingvocab_stage2 <- raw_dat$bdbasa00
dat$neuro_cognition_namingvocab_stage2[raw_dat$neuro_cognition_namingvocab_stage2<0]<-NA
dat$neuro_cognition_namingvocab_stage2_zscore <- scale(dat$neuro_cognition_namingvocab_stage2)

# ability score for pattern construction (british ability score)
#The child constructs a design by putting together flat squares or solid cubes with
#black and yellow patterns on each side. The child’s score is based on accuracy and
#speed. This assessment tests spatial awareness but can also be used to observe
#dexterity and coordination, as well as traits like perseverance and determination.

dat$neuro_cognition_spatialawareness_stage3 <- raw_dat$cdpcabil
dat$neuro_cognition_spatialawareness_stage3[raw_dat$neuro_cognition_spatialawareness_stage3<0]<-NA
dat$neuro_cognition_spatialawareness_stage3_zscore <- scale(dat$neuro_cognition_spatialawareness_stage3)

# ability score for picture similarity (BAS)
#Children are shown a row of 4 pictures on a page and asked to place a card with a
#fifth picture under the picture most similar to it. This assessment measures children’s
#problem solving abilities.

dat$neuro_cognition_problemsolving_stage3 <- raw_dat$cdpsabil
dat$neuro_cognition_problemsolving_stage3[raw_dat$neuro_cognition_problemsolving_stage3<0]<-NA
dat$neuro_cognition_problemsolving_stage3_zscore <- scale(dat$neuro_cognition_problemsolving_stage3)

# Word Reading is an assessment from the British Ability Scales: Second Edition (BAS
# 2) which assesses children’s English reading ability.

dat$neuro_cognition_reading_stage3 <- raw_dat$dcwrab00
dat$neuro_cognition_reading_stage3[raw_dat$neuro_cognition_reading_stage3<0]<-NA
dat$neuro_cognition_reading_stage3_zscore <- scale(dat$neuro_cognition_reading_stage3)

# School Readiness (Bracken)

# The Bracken Basic Concept Scale – Revised (BBCS-R) is used to assess the basic
# concept development in children in the age range of 2 years 6 months to 7 years 11
# months. BBCS–R measures the comprehension of 308 functionally relevant
# educational concepts in 11 subtests or concept categories. Following consultation
# with advisers and piloting, only subtests 1-6 were administered by interviewers to the
# members of the cohort during the MCS2 data collection.

dat$neuro_cognition_schoolreadiness_stage2 <- raw_dat$bdbsrc00
dat$neuro_cognition_schoolreadiness_stage2[dat$neuro_cognition_schoolreadiness_stage2<0]<-NA
dat$neuro_cognition_schoolreadiness_stage2_zscore  <- dat$neuro_cognition_schoolreadiness_stage2

# Number skills
# This test was adapted from the NFER Progress in Maths test which is aimed for 7-
# year-olds and was originally developed and nationally UK standardised in 2004. The
# whole test has a maximum raw score of 28. The national mean raw score in 2004
# was 19.3 with a standard deviation of 5.3.

dat$neuro_cognition_numberskills_stage3 <- raw_dat$maths7sc
dat$neuro_cognition_numberskills_stage3[dat$neuro_cognition_numberskills_stage3<0]<-NA
dat$neuro_cognition_numberskills_stage3_zscore  <- dat$neuro_cognition_numberskills_stage3

#Educational attainment


```
# Immunological

Ideal harmonised immunological health measures for offspring are:

asthma
Wheeze
eczema
Eczema-like rash
Allergies (pet, pollen, mite/dust, bee/wasp, food)

```{r eval=FALSE, include=TRUE}
# asthma
dat$immuno_asthma_stage2_binary <- NA
dat$immuno_asthma_stage2_binary[raw_dat$bmasmaa0 ==2 ] <- 0
dat$immuno_asthma_stage2_binary[raw_dat$bmasmaa0 ==1 ] <- 1

dat$immuno_asthma_stage3_binary <- NA
dat$immuno_asthma_stage3_binary[raw_dat$cmasmaa0 ==2 | raw_dat$dmasmaa0 ==2 ] <- 0
dat$immuno_asthma_stage3_binary[raw_dat$cmasmaa0 ==1 | raw_dat$dmasmaa0 ==1] <- 1

dat$immuno_asthma_allstages_binary <- NA 
dat$immuno_asthma_allstages_binary[dat$immuno_asthma_stage2_binary==0 | dat$immuno_asthma_stage3_binary ==0 ] <- 0
dat$immuno_asthma_allstages_binary[dat$immuno_asthma_stage2_binary==1 | dat$immuno_asthma_stage3_binary ==1 ] <- 1

# wheeze
dat$immuno_wheeze_stage2_binary <- NA
dat$immuno_wheeze_stage2_binary[raw_dat$bmwhlya0 ==2 | raw_dat$bmwheea0 ==2] <- 0
dat$immuno_wheeze_stage2_binary[raw_dat$bmwhlya0 ==1 | raw_dat$bmwheea0 ==1] <- 1

dat$immuno_wheeze_stage3_binary <- NA 
dat$immuno_wheeze_stage3_binary[raw_dat$cmwhlya0 ==2 | raw_dat$dmwhlya0 ==2 | raw_dat$cmwheea0 ==2 | raw_dat$dmwheea0 ==2] <- 0
dat$immuno_wheeze_stage3_binary[raw_dat$cmwhlya0  ==1 | raw_dat$dmwhlya0 ==1 |raw_dat$cmwheea0  ==1 | raw_dat$dmwheea0 ==1] <- 1

dat$immuno_wheeze_allstages_binary <- NA 
dat$immuno_wheeze_allstages_binary[dat$immuno_wheeze_stage2_binary==0 | dat$immuno_wheeze_stage3_binary ==0 ] <- 0
dat$immuno_wheeze_allstages_binary[dat$immuno_wheeze_stage2_binary==1 | dat$immuno_wheeze_stage3_binary ==1 ] <- 1

#eczema (question for stage 2 was about eczema OR hayfever, so have dropped this question)
dat$immuno_eczema_stage3_binary <- NA 
dat$immuno_eczema_stage3_binary[raw_dat$cmeczma0 ==2 | raw_dat$dmeczma0 ==2 ] <- 0
dat$immuno_eczema_stage3_binary[raw_dat$cmeczma0  ==1 | raw_dat$dmeczma0 ==1] <- 1

dat$immuno_eczema_allstages_binary <- dat$immuno_eczema_stage3_binary

#allergy

dat$immuno_allergy_hay_stage3_binary <- NA 
dat$immuno_allergy_hay_stage3_binary[raw_dat$cmhafva0 ==2 | raw_dat$dmhafva0 ==2 ] <- 0
dat$immuno_allergy_hay_stage3_binary[raw_dat$cmhafva0  ==1 | raw_dat$dmhafva0 ==1] <- 1

dat$immuno_allergy_hay_allstages_binary <- dat$immuno_allergy_hay_stage3_binary

```
# Covariates

Demographics

* Ethnicity
* Maternal and paternal age at conception and/or delivery 
* Maternal and paternal education
* Maternal and paternal occupation
* Parity (number of previous children) - cannot find this information!
* Sex of child

```{r eval=FALSE, include=TRUE}

dat$covs_ethnicity_mother<- NA
dat$covs_ethnicity_mother[raw_dat$amdeea00%in%c(1,2,3)]<-"white"
dat$covs_ethnicity_mother[raw_dat$amdeea00%in%c(4,5,6,7,95)]<-"mixed or other"
dat$covs_ethnicity_mother[raw_dat$amdeea00%in%c(8,9,10,11,15)]<-"asian"
dat$covs_ethnicity_mother[raw_dat$amdeea00%in%c(12,13,14)]<-"black"

dat$covs_ethnicity_mother_binary <- NA
dat$covs_ethnicity_mother_binary[dat$covs_ethnicity_mother%in%c("white")]<-"white"
dat$covs_ethnicity_mother_binary[dat$covs_ethnicity_mother%in%c("asian","black","mixed or other")]<-"not white"

dat$covs_ethnicity_father<- NA
dat$covs_ethnicity_father[raw_dat$apdeea00%in%c(1,2,3)]<-"white"
dat$covs_ethnicity_father[raw_dat$apdeea00%in%c(4,5,6,7,95)]<-"mixed or other"
dat$covs_ethnicity_father[raw_dat$apdeea00%in%c(8,9,10,11,15)]<-"asian"
dat$covs_ethnicity_father[raw_dat$apdeea00%in%c(12,13,14)]<-"black"

dat$covs_ethnicity_father_binary <- NA
dat$covs_ethnicity_father_binary[dat$covs_ethnicity_father%in%c("white")]<-"white"
dat$covs_ethnicity_father_binary[dat$covs_ethnicity_father%in%c("asian","black","mixed or other")]<-"not white"

dat$covs_ethnicity_child<- NA
dat$covs_ethnicity_child[raw_dat$adceeaa0%in%c(1,2,3)]<-"white"
dat$covs_ethnicity_child[raw_dat$adceeaa0%in%c(4,5,6,7,95)]<-"mixed or other"
dat$covs_ethnicity_child[raw_dat$adceeaa0%in%c(8,9,10,11,15)]<-"asian"
dat$covs_ethnicity_child[raw_dat$adceeaa0%in%c(12,13,14)]<-"black"

dat$covs_ethnicity_child_binary <- NA
dat$covs_ethnicity_child_binary[dat$covs_ethnicity_child%in%c("white")]<-"white"
dat$covs_ethnicity_child_binary[dat$covs_ethnicity_child%in%c("asian","black","mixed or other")]<-"not white"

dat$covs_age_mother_delivery <- raw_dat$amdagb00
dat$covs_age_mother_delivery[dat$covs_age_mother_delivery<0]<-NA

dat$covs_age_father_delivery <- raw_dat$apdagb00
dat$covs_age_father_delivery[dat$covs_age_father_delivery<0]<-NA

# for education, vocational qualifications were mapped to the academic quals listed below
dat$covs_edu_mother<-NA
dat$covs_edu_mother[raw_dat$amdnvq00 %in% c(4,5)]<-3 #degree, HE diploma
dat$covs_edu_mother[raw_dat$amdnvq00==3]<-2 # A level,
dat$covs_edu_mother[raw_dat$amdnvq00%in%c(1,2)]<-1 #O level or GCSE
dat$covs_edu_mother[raw_dat$amdnvq00==96]<-0 #None of these

dat$covs_edu_father<-NA
dat$covs_edu_father[raw_dat$apdnvq00 %in% c(4,5)]<-3 #degree, HE diploma
dat$covs_edu_father[raw_dat$apdnvq00==3]<-2 # A level,
dat$covs_edu_father[raw_dat$apdnvq00%in%c(1,2)]<-1 #O level or GCSE
dat$covs_edu_father[raw_dat$apdnvq00==96]<-0 #None of these

dat$covs_occup_mother <- NA
dat$covs_occup_mother[raw_dat$amd05s00==1]<-3 #professional or managerial
dat$covs_occup_mother[raw_dat$amd05s00%in%c(2,3)]<-2 #intermediate and small employer and self-employed
dat$covs_occup_mother[raw_dat$amd05s00==4]<-1 #low supervisory and technical
dat$covs_occup_mother[raw_dat$amd05s00==5]<-0 #semi-routine or routine

dat$covs_occup_father <- NA
dat$covs_occup_father[raw_dat$apd05s00==1]<-3 #professional or managerial
dat$covs_occup_father[raw_dat$apd05s00%in%c(2,3)]<-2 #intermediate and small employer and self-employed
dat$covs_occup_father[raw_dat$apd05s00==4]<-1 #low supervisory and technical
dat$covs_occup_father[raw_dat$apd05s00==5]<-0 #semi-routine or routine


```


Family relationships

* Marital status of mother and partner
* Co-habitation of mother and partner during preg

```{r eval=FALSE, include=TRUE}
dat$covs_partner_lives_with_mother_prenatal<-NA
dat$covs_partner_lives_with_mother_prenatal[raw_dat$adrelp00%in%c(1,2)]<-1 #15228 (parents married or co-habiting)
dat$covs_partner_lives_with_mother_prenatal[raw_dat$adrelp00==3]<-0 # 18 (neither)

dat$covs_married_mother_binary<-NA
dat$covs_married_mother_binary[raw_dat$adrelp00%in%c(2,3)]<-0
dat$covs_married_mother_binary[raw_dat$adrelp00==1]<-1

dat$covs_married_father_binary<-dat$covs_married_mother_binary

```

Parents’ health

* Maternal and paternal current illnesses and health problems (diabetes, asthma, eczema, etc) 
* Maternal and paternal mental health 
* Maternal and paternal height and weight

```{r eval=FALSE, include=TRUE}

dat$covs_asthma_mother_binary <- NA
dat$covs_asthma_mother_binary[raw_dat$amasth00==1]<-1
dat$covs_asthma_mother_binary[raw_dat$amasth00==2]<-0

dat$covs_asthma_father_binary <- NA
dat$covs_asthma_father_binary[raw_dat$apasth00==1]<-1
dat$covs_asthma_father_binary[raw_dat$apasth00==2]<-0

dat$covs_eczema_mother_binary <- NA
dat$covs_eczema_mother_binary[raw_dat$ameczm00==1]<-1
dat$covs_eczema_mother_binary[raw_dat$ameczm00==2]<-0

dat$covs_eczema_father_binary <- NA
dat$covs_eczema_father_binary[raw_dat$apeczm00==1]<-1
dat$covs_eczema_father_binary[raw_dat$apeczm00==2]<-0

dat$covs_diabetes_mother_binary <- NA
dat$covs_diabetes_mother_binary[raw_dat$amdiab00==1 & raw_dat$amdiwt0a!=1]<-1
dat$covs_diabetes_mother_binary[raw_dat$amdiab00==2 | raw_dat$amdiwt0a==1]<-0

dat$covs_diabetes_father_binary <- NA
dat$covs_diabetes_father_binary[raw_dat$apdiab00==1]<-1
dat$covs_diabetes_father_binary[raw_dat$apdiab00==2]<-0

#Do you have a longstanding illness, disability or infirmity. By longstanding I mean anything that has troubled you over a period of time or that is likely to affect you over a period of time?
dat$covs_mother_illness_binary <- NA
dat$covs_mother_illness_binary[raw_dat$amloil00==1]<-1
dat$covs_mother_illness_binary[raw_dat$amloil00==2]<-0

dat$covs_father_illness_binary <- NA
dat$covs_father_illness_binary[raw_dat$aploil00==1]<-1
dat$covs_father_illness_binary[raw_dat$aploil00==2]<-0

dat$covs_mother_depression_binary <- NA
dat$covs_mother_depression_binary[raw_dat$amdean00==1]<-1
dat$covs_mother_depression_binary[raw_dat$amdean00==2]<-0

dat$covs_father_depression_binary <- NA
dat$covs_father_depression_binary[raw_dat$apdean00==1]<-1
dat$covs_father_depression_binary[raw_dat$apdean00==2]<-0

dat$covs_height_mother <-raw_dat$amhgtm00
dat$covs_weight_mother <-raw_dat$amwgbk00 # weight in kilos before baby born
dat$covs_height_mother[raw_dat$amhgtm00<0.1] <- NA
dat$covs_weight_mother[raw_dat$amwgbk00<20] <- NA
dat$covs_bmi_mother <- dat$covs_weight_mother/(dat$covs_height_mother^2)
dat$covs_bmi_mother_zscore <-scale(dat$covs_bmi_mother)

dat$covs_height_father <-raw_dat$aphgtm00
dat$covs_weight_father <-raw_dat$apwgtk00 # weight in kilos at time of interview
dat$covs_height_father[raw_dat$aphgtm00<0.1] <- NA
dat$covs_weight_father[raw_dat$apwgtk00<20] <- NA
dat$covs_bmi_father <- dat$covs_weight_father/(dat$covs_height_father^2)
dat$covs_bmi_father_zscore <-scale(dat$covs_bmi_father)

```

Pregnancy complications

* Hypertensive disorders of pregnancy
* Gestational diabetes

```{r eval=FALSE, include=TRUE}
dat$covs_hdp_binary<-NA
dat$covs_hdp_binary[raw_dat$amilpr00%in% c(1,2)]<-0
dat$covs_hdp_binary[raw_dat$amilwm0a==5|raw_dat$amilwm0b==5|raw_dat$amilwm0c==5|raw_dat$amilwm0d==5|raw_dat$amilwm0e==5|raw_dat$amilwm0f==5|raw_dat$amilwm0g==5]<-1

#existing or gestational diabetes (named glycosuria to match alspac)
dat$covs_glycosuria_binary<-NA
dat$covs_glycosuria_binary[raw_dat$amilpr00%in% c(1,2)]<-0
dat$covs_glycosuria_binary[raw_dat$amilwm0a==7|raw_dat$amilwm0b==7|raw_dat$amilwm0c==7|raw_dat$amilwm0d==7|raw_dat$amilwm0e==7|raw_dat$amilwm0f==7|raw_dat$amilwm0g==7]<-1
dat$covs_glycosuria_binary[dat$covs_diabetes_mother_binary==1]<-1
```

Child’s health

Look at http://cls.nemisys3.uk.com/datadictionary/page.asp?section=000100010003000300020001&sectionTitle=A%2E+Main+Interview for coding

* Gestational age at delivery
* Duration of breastfeeding (e.g. ambfeaa0)
* Child’s own smoking 
* Child’s own drinking of alcohol
* Child’s own consumption of caffeine
* Child’s exposure to passive smoke (e.g. amsmkr00, CMSMKR00, BMSMKR00, DMSMKR00)


```{r eval=FALSE, include=TRUE}
#Gestage
dat$covs_gestage <- raw_dat$adgesta0
dat$covs_gestage[dat$covs_gestage <0]<-NA
dat$covs_gestage <- dat$covs_gestage/7

dat$covs_preterm_binary <- NA
dat$covs_preterm_binary[dat$covs_gestage<37]<-1
dat$covs_preterm_binary[dat$covs_gestage>=37]<-0

#Duration of breastfeeding

dat$covs_breastfeeding_ordinal <- NA
dat$covs_breastfeeding_ordinal[raw_dat$ambfeva0==2 | raw_dat$ambfeaa0==1] <-0 #never tried
dat$covs_breastfeeding_ordinal[raw_dat$ambfeaa0==2 | raw_dat$ambfeda0 %in% 1:89 | raw_dat$ambfewa0 %in% 1:11 | raw_dat$ambfema0 %in% 1:2 | raw_dat$cmbfema0%in% 1:2] <-1 #less than 3 months (variables are less than 1 day, duration in days, duration in weeks, duration in months)
dat$covs_breastfeeding_ordinal[raw_dat$ambfeda0 %in% 90:180 | raw_dat$ambfewa0 %in% 12:23 | raw_dat$ambfema0 %in% 3:5 | raw_dat$cmbfema0%in% 3:5] <-2 #3- <6 months
dat$covs_breastfeeding_ordinal[raw_dat$ambfeda0 %in% 180:10000| raw_dat$ambfewa0 %in% 24:10000 | raw_dat$ambfema0 %in% 6:10000|
                              raw_dat$cmbfema0%in% 6:10000 | raw_dat$cmbfeya0>=1  | raw_dat$bmbfeaa0==3 | raw_dat$cmbfeaa0==3 ] <-3 #6+ months (duration in days, duration in weeks, duration in months, years, still breastfeeding))

#Child’s exposure to passive smoke

dat$covs_passivesmk_child_stage0_binary <- NA
dat$covs_passivesmk_child_stage0_binary[raw_dat$amsmkr00==2] <- 0
dat$covs_passivesmk_child_stage0_binary[raw_dat$amsmkr00==1] <- 1

dat$covs_passivesmk_child_stage2_binary <- NA
dat$covs_passivesmk_child_stage2_binary[raw_dat$bmsmkr00==2] <- 0
dat$covs_passivesmk_child_stage2_binary[raw_dat$bmsmkr00==1] <- 1

dat$covs_passivesmk_child_stage3_binary <- NA
dat$covs_passivesmk_child_stage3_binary[raw_dat$cmsmkr00==2|raw_dat$dmsmkr00==2] <- 0
dat$covs_passivesmk_child_stage3_binary[raw_dat$cmsmkr00==1|raw_dat$dmsmkr00==1] <- 1

```


# Save
```{r eval=FALSE, include=TRUE}
saveRDS(dat,"/Volumes/MRC-IEU-research/projects/ieu2/p5/015/working/data/mcs/mcs_pheno.rds")

```

